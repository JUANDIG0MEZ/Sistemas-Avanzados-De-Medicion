\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.
%Template version as of 6/27/2024

\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{svg}
\usepackage{textcomp}
\usepackage{xcolor}
\usepackage{amsmath}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}

\title{Examen 2: Sistemas Avanzados de medici\'on\\
	\thanks{Identify applicable funding agency here. If none, delete this.}
}

\author{\IEEEauthorblockN{1\textsuperscript{st} Juan Camil Vasco Leiva}
	\IEEEauthorblockA{\textit{Maestr\'ia en Ingenier\'ia El\'ectrica} \\
		\textit{Universidad T\'ecnologia de Pereira}\\
		Pereira, Colombia \\
		camilo.vasco@utp.edu.co}
	\and
	\IEEEauthorblockN{2\textsuperscript{nd} Juan Diego G\'omez Chavarro}
	\IEEEauthorblockA{\textit{Maestr\'ia en Ingenier\'ia El\'ectrica} \\
		\textit{Universidad T\'ecnologica de Pereira}\\
		Periera, Colombia \\
		juandiego.gomez1@utp.edu.co}

}

\maketitle

\begin{IEEEkeywords}
	Filtro de kalman,
\end{IEEEkeywords}

\section{Introducción}

Este trabajo consiste en recuperar dos variables físicas a partir de las mediciones y de los modelos de cada sensor, utilizando el filtro de Kalman y series de Fourier. En este caso, se utilizaron dos sensores diferentes: el primero es un sensor de fuerza con un modelo de segundo orden, y el segundo es un sensor desconocido con un modelo de primer orden. Dado que no se cuenta con el hardware necesario para hacer el experimento, se realizo la simulacion mediante \textit{hardware-in-the-loop} en el cual se simula cada una de las variables fisicas y se simula sistema el sistema dinamico de cada sensor.

\section{Metodolog\'ia}




\subsection{Modelo segundo orden}

% Modelado en Espacio de Estados
% Sensor d Segundo Orden
\begin{equation}
	\frac{d^2y}{dt^2} + 2\zeta\omega_n \frac{dy}{dt} + \omega_n^2 y = \frac{K_s}{m} F(t)
\end{equation}
Donde la se\~nal $y(t)$ es la salida del sensor, $\zeta$ es un coeficiente de amortiguamiento, $\omega_n$ se conoce como la frecuencia natual de oscilaci\'on del sistema, ${K_s}$ es una constante de rigidez y $m$ es una masa asociada al sistema de amortiguamiento.

Esta ecuaci\'on diferencial puede transformarse en un modelo en el espacio de estados
\[
\dot{x}(t) = \mathbf{A}\mathbf{x}(t) + \mathbf{w}(t)
\]
Donde los estados son:
\[
	\mathbf{x} = 
	\begin{bmatrix}
	\dot{x}_1 \\
	\dot{x}_2 \\
	\dot{x}_3
	\end{bmatrix} =
	\begin{bmatrix}
		\dot{y} \\
		\dot\dot{y} \\
		\dot{F}(t)
	\end{bmatrix}
\]
Cada variable de estado puede definirse de la siguiente forma:
\[
	\dot{x}_1 = \frac{ dx}{dt}
\]
\[
	\dot{x}_1 = x_2
\]
\[
	\dot{x}_2 = -2\zeta\omega_n x_2 - \omega_n^2x_1 + \frac{K_s}{m}F(t)
\]
Por otro lado, la variacion temporal de la fuerza se modela como un proceso estocastico.
\[
	\dot{x}_3 =  \omega_{F}(t)
\]
Dicho lo anterior, se puede establecer que el modelo de espacios de estados es el siguiente.


\begin{equation*}
	\underbrace{
		\begin{bmatrix}
			\dot{x}_1 \\
			\dot{x}_2 \\
			\dot{x}_3
		\end{bmatrix}
	}_{\mathbf{\dot{x}}(t)}
	=
	\underbrace{\begin{bmatrix}
			0           & 1                & 0 \\
			-\omega_n^2 & -2\zeta\omega_n  &  \frac{K_s}{m} \\
			0			& 0				   & 0
	\end{bmatrix}}_{\mathbf{A}}
	\underbrace{\begin{bmatrix}
			x_1 \\
			x_2 \\
			x_3
	\end{bmatrix}}_{\mathbf{x}(t)}	
	+
	\underbrace{
	\begin{bmatrix}
		0 \\
		0 \\
		w_{F}(t)
	\end{bmatrix}
	}_{\mathbf{w}(t)}	
\end{equation*}

dicho lo anterior:
\[
\mathbf{F} = 
\begin{bmatrix}
	1           & \Delta t            & 0 \\
	-\omega_n^2 \cdot \Delta t   & 1 -2\zeta\omega_n \cdot \Delta t   &  \frac{K_s}{m} \cdot \Delta t  \\
	0			& 0				   & 1
\end{bmatrix}, 
\mathbf{H} = 
\begin{bmatrix}
	1 & 0 & 0
\end{bmatrix}
\]


Mientras que 


\[
\mathbf{Q} =  \begin{bmatrix}
	0   & 0    & 0 \\
	0   & 0    & 0  \\
	0   & 0	   & q_F \cdot \Delta t
\end{bmatrix}, \mathbf{R} = [r_F]
\]

Donde $q_f$ es la varianza de la tasa de cambio $\mathbf{\dot{F}}(t) = \omega_{F}$ y $r_F$ es la incertidumbre en la medici\'on.

Por ultimo, el vector de medicion es

\[
\textbf{z}[n] = \textbf{H} \textbf{x}[n] + \textbf{v}[n] ,
\mathbf{v} = \sqrt[]{r}
\]


\subsection{Modelo primero orden}

\[
\tau \frac{dy}{dt} + y = K_s u(t)
\]

Siguiendo un procedimiento similar al del modelo de segundo orden. se puede demostrar que:
\begin{equation*}
	\underbrace{
		\begin{bmatrix}
			\dot{x}_1 \\
			\dot{u}(t)
		\end{bmatrix}
	}_{\mathbf{\dot{x}}(t)}
	=
	\underbrace{\begin{bmatrix}
			-\frac{1}{\tau}           & \frac{K_s}{\tau}                 \\
			0 & 0   \\
	\end{bmatrix}}_{\mathbf{A}}
	\underbrace{\begin{bmatrix}
			x_1 \\
			u(t) 
	\end{bmatrix}}_{\mathbf{x}(t)}	
	+
	\underbrace{
		\begin{bmatrix}
			0 \\
			w_{u}(t)
		\end{bmatrix}
	}_{\mathbf{w}(t)}
\end{equation*}

\[
	\mathbf{F} = \begin{bmatrix}
		1 -\frac{1}{\tau} \cdot \Delta t          & \frac{K_s}{\tau} \cdot \Delta t               \\
		0 & 1 \\
	\end{bmatrix},
	\mathbf{H} =
	\begin{bmatrix}
		1 & 0
	\end{bmatrix}
\]

\[
\mathbf{Q} = \begin{bmatrix}
	0 & 0  \\
	0 & q_u \cdot \Delta t \\
\end{bmatrix}, 
\mathbf{R} = [r_u]
\]



\subsection{Fourier}


\[
	\mathcal{F}\left\{ \frac{d^2y}{dt^2} \right\} + 2\zeta\omega_n \mathcal{F}\left\{\frac{dy}{dt}\right\} + \omega_n^2 \mathcal{F}\left\{y\right\} = \frac{K_s}{m} \mathcal{F}\left\{F(t)\right\}
\]
\[
	-\omega^2 Y(\omega)  + 2j\zeta\omega_n\omega Y(\omega) + \omega^2 Y(\omega) = \frac{K_s}{m}F(\omega)
\]
	
\[
	\left(-\omega^2  + 2j\zeta\omega_n\omega + \omega^2 \right) Y(\omega) = \frac{K_s}{m} F(\omega)
\]

\[
	F(\omega) = \frac{m}{K_s}  \left(-\omega^2  + 2j\zeta\omega_n\omega + \omega^2 \right) Y(\omega)
\]


\[
	 F(\omega) = m/K_s [A(\omega)] = 
\]

\subsection{Filtro de Kalman Lineal(LKF)}

El filtro de Kalman estima los estados $\textbf{x} = [x_1, x_2, x_3]^T$ a partir de dos pasos 1) prediccion y 2) actualizacion.



\subsubsection{Predicci\'on}


\[
\hat{\mathbf{x}}_k^- = \mathbf{F}\hat{\mathbf{x}^+_{k-1}}
\]
\[
\mathbf{P^-_k} = \mathbf{F} \mathbf{P}_{k-1} \mathbf{F^T} + \mathbf{Q}
\]

\subsubsection{Actualizaci\'on}

\[
\mathbf{K}_k = \mathbf{P}_k^- \mathbf{H}^T \left( \mathbf{H} \mathbf{P}_k^- \mathbf{H}^T + \mathbf{R} \right)^{-1}
\]

\[
\hat{\mathbf{x}}_k^+ = \hat{\mathbf{x}}_k^- + \mathbf{K}_k \left( \mathbf{z}_k - \mathbf{H} \hat{\mathbf{x}}_k^- \right)
\]

\[
\mathbf{P}_k^+ = \left( \mathbf{I} - \mathbf{K}_k \mathbf{H} \right) \mathbf{P}_k^-
\]

Donde $\mathbf{F}\approx \mathbf{I} - \mathbf{A}(\Delta t) $ es la matriz de transicion, $\mathbf{H}$  la matriz de medicion, .





\section{Resultados (hardware in the loop)}

\subsection{Modelo segundo orden}

\begin{table}[h]
	\centering
	\caption{Parametros modelo de segundo orden.}
	\label{tab:parametros_segundo_orden}
	\begin{tabular}{|c|c|c|}
		\hline
		\textbf{Parametros} & \textbf{Valores} \\
		\hline
		$\zeta$  &  0 \\
		$\omega_n$      & 0 \\
		$m$ & 0 \\
		$\omega_F$ & 0 \\
		$ q_F $  &  0\\
		$\Delta t$ & 0\\  
		$r_F$ & 0 \\ 
		\hline
	\end{tabular}
	
\end{table}




\begin{figure}[h]
	\centering
	\includegraphics[width=0.5\textwidth]{../CodigoPython/EstimacionX1.png}
	\caption{Descripción de la imagen.}
	\label{fig:etiqueta}
\end{figure}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.5\textwidth]{../CodigoPython/EstimacionF.png}
	\caption{Descripción de la imagen.}
	\label{fig:etiqueta}
\end{figure}


\subsection{Modelo de primer orden}

\begin{table}[h]
	\centering
	\caption{Parametros modelo de primer orden}
	\label{tab:parametros_primer_orden}
	\begin{tabular}{|c|c|c|}
		\hline
		\textbf{Parametros} & \textbf{Valores} \\
		\hline
		$\tau$  &  0 \\
		$K_s$      & 0 \\
		$q_u$ & 0 \\
		$\Delta t$ & 0\\  
		$r_u$ & 0 \\ 
		\hline
	\end{tabular}
	
\end{table}

Imagen generada mediante hardware in the loop(Borra esta fras)

\begin{figure}[h]
	\centering
	\includegraphics[width=0.5\textwidth]{../CodigoPython/SegundoOrden.png}
	\caption{Descripción de la imagen}
	\label{fig:etiqueta}
\end{figure}




\section{Conclusiones}

Aqui van las conclusiones

\begin{thebibliography}{00}

	\item Clases magistrales e información suministrada en la clase de Sistemas de medición avanzada, Maestria en ingenieria electrica, semestre 2025-1

\end{thebibliography}

\end{document}
